from django.http import HttpResponse
from django.shortcuts import render, get_object_or_404, render_to_response
from .models import Exploit


# Create your views here.
def index(request, pk):
    exploit = get_object_or_404(Exploit, pk=pk)
    return render(request, 'exploit/exploit.html', {'exploit': exploit})


def raw(request, pk):
    raw_code = get_object_or_404(Exploit, pk=pk)
    return render(request, 'exploit/raw.html', {'raw_code': raw_code}, content_type="text/plain")


def browse(request):
    exploit = Exploit.objects.all()
    # return render(request, )


def local(request):
    exploit = Exploit.objects.filter(type=2)[:15]
    return render(request, 'exploit/local.html', {'exploit': exploit})


def remote(request):
    exploit = Exploit.objects.filter(type=3)[:15]
    return render(request, 'exploit/remote.html', {'exploit': exploit})


def web(request):
    exploit = Exploit.objects.filter(type=1)[:15]
    return render(request, 'exploit/web.html', {'exploit': exploit})


def shell(request):
    exploit = Exploit.objects.filter(type=4)[:15]
    return render(request, 'exploit/shell.html', {'exploit': exploit})


def dos(request):
    exploit = Exploit.objects.filter(type=5)[:15]
    return render(request, 'exploit/dos.html', {'exploit': exploit})


def home(request):
    web_app = Exploit.objects.filter(type=1)[:7]
    shellcode = Exploit.objects.filter(type=4)[:7]
    remote_exploit = Exploit.objects.filter(type=3)[:7]
    dos_exploit = Exploit.objects.filter(type=5)[:7]
    local_exploit = Exploit.objects.filter(type=2)[:7]
    return render(request, 'exploit/home.html', {
        'web_app': web_app,
        'shellcode': shellcode,
        'remote_exploit': remote_exploit,
        'dos_exploit': dos_exploit,
        'local_exploit': local_exploit
    })
